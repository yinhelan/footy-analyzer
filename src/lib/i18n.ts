export type Lang = 'zh' | 'en'

const dict: Record<Lang, Record<string, string>> = {
  zh: {
    langLabel: '语言',
    appSubtitle: '自用竞彩足球分析（稳健风格）｜输入粘贴文本，输出可复制建议',
    panelConfig: '可视化策略面板（V1）',
    panelInput: '输入（每行一场）',
    panelOutput: '输出（纯文本）',
    panelHistory: '历史记录（localStorage）',
    panelCompare: '结构化对比结果',
    crowdThreshold: '热门拥挤阈值（%）',
    heatThreshold: '热度阈值（|冷热|）',
    totalBudget: '总预算（RMB）',
    parlayBudget: '主串预算（RMB）',
    singleBudget: '单场预算（RMB）',
    coldBudget: '条件博冷预算（RMB）',
    handicapEnabled: '启用让球推荐',
    handicapCrowdThreshold: '让球拥挤阈值（%）',
    handicapHeatThreshold: '让球热度阈值（|冷热|）',
    handicapExtraBudget: '让球独立预算（RMB）',
    policyV38Enabled: '启用 v3.8 硬规则审计模式',
    applyConservative: '应用预设：稳健',
    applyAggressive: '应用预设：激进',
    tagB1: '标签映射 B1',
    tagC1: '标签映射 C1',
    tagC8: '标签映射 C8',
    tagC9: '标签映射 C9',
    fixTarget: '修复对象：',
    fillExample: '填入示例',
    fillDynamicTemplate: '填入动态模板',
    patchTS: '补T/快照',
    patchV: '补V_total',
    patchHP: '补H_fav/PL_fav',
    undoBtn: '撤销一步',
    redoBtn: '重做一步',
    doneSteps: '已完成：',
    generate: '生成',
    saveHistory: '保存到历史',
    parsedCountPrefix: '已解析',
    matchesSuffix: '场',
    copyOneClick: '一键复制',
    copied: '已复制',
    dateFilter: '日期筛选：',
    today: '今天',
    last7d: '近7天',
    all: '全部',
    keywordPlaceholder: '关键词（队名）',
    compareAction: '对比（勾选两条或自动同场）',
    noHistory: '暂无历史',
    parsedShortPrefix: '解析',
    load: '加载',
    exportTxt: '导出TXT',
    delete: '删除',
    noUndo: '无可撤销步骤',
    noRedo: '无可重做步骤',
    undoDone: '已撤销一步',
    redoDone: '已重做一步',
    parseZero: '解析场次为0，请检查输入格式',
    analysisRefreshed: '分析结果已刷新',
    hardRuleStopPrefix: '硬规则停机：',
    mergedUpdated: '已更新多项配置',
    patchedPrefix: '已补第',
    patchedSuffix: '场：',
    exportFallbackShort: '导出已回退历史输出',
    exportFallbackDetails: '重算失败，已使用历史存档输出。',
    exportFallbackAction: '查看详情',
    exportFallbackClose: '收起',
    copyErrorSummary: '复制错误摘要',
    copyDiagnosticPack: '复制完整诊断包',
    copyDiagnosticPackMasked: '复制脱敏诊断包',
    maskLevelLabel: '脱敏级别',
    maskBadgePrefix: '脱敏',
    maskLevelHint: '影响脱敏诊断包复制',
    maskLegend: 'A=更保守，B=更多信息',
    showLegend: '显示图例',
    hideLegend: '收起图例',
    zhOnlyProbe: '仅中文回退',
  },
  en: {
    langLabel: 'Language',
    appSubtitle: 'Football analysis (steady style) | paste input text and get copy-ready output',
    panelConfig: 'Visual Strategy Panel (V1)',
    panelInput: 'Input (one match per line)',
    panelOutput: 'Output (plain text)',
    panelHistory: 'History (localStorage)',
    panelCompare: 'Structured Compare Result',
    crowdThreshold: 'Crowd Threshold (%)',
    heatThreshold: 'Heat Threshold (|heat|)',
    totalBudget: 'Total Budget (RMB)',
    parlayBudget: 'Parlay Budget (RMB)',
    singleBudget: 'Single Budget (RMB)',
    coldBudget: 'Cold Hedge Budget (RMB)',
    handicapEnabled: 'Enable handicap recommendation',
    handicapCrowdThreshold: 'Handicap crowd threshold (%)',
    handicapHeatThreshold: 'Handicap heat threshold (|heat|)',
    handicapExtraBudget: 'Handicap extra budget (RMB)',
    policyV38Enabled: 'Enable v3.8 hard-rule audit mode',
    applyConservative: 'Apply preset: Conservative',
    applyAggressive: 'Apply preset: Aggressive',
    tagB1: 'Tag mapping B1',
    tagC1: 'Tag mapping C1',
    tagC8: 'Tag mapping C8',
    tagC9: 'Tag mapping C9',
    fixTarget: 'Repair target:',
    fillExample: 'Fill example',
    fillDynamicTemplate: 'Fill dynamic template',
    patchTS: 'Patch T/snapshots',
    patchV: 'Patch V_total',
    patchHP: 'Patch H_fav/PL_fav',
    undoBtn: 'Undo one step',
    redoBtn: 'Redo one step',
    doneSteps: 'Done: ',
    generate: 'Generate',
    saveHistory: 'Save to history',
    parsedCountPrefix: 'Parsed',
    matchesSuffix: 'matches',
    copyOneClick: 'Copy',
    copied: 'Copied',
    dateFilter: 'Date filter:',
    today: 'Today',
    last7d: 'Last 7 days',
    all: 'All',
    keywordPlaceholder: 'Keyword (team)',
    compareAction: 'Compare (pick 2 or auto same-match)',
    noHistory: 'No history',
    parsedShortPrefix: 'Parsed',
    load: 'Load',
    exportTxt: 'Export TXT',
    delete: 'Delete',
    noUndo: 'Nothing to undo',
    noRedo: 'Nothing to redo',
    undoDone: 'Undo applied',
    redoDone: 'Redo applied',
    parseZero: 'Parsed matches = 0, please check input format',
    analysisRefreshed: 'Analysis refreshed',
    hardRuleStopPrefix: 'Hard-rule stop: ',
    mergedUpdated: 'Multiple settings updated',
    patchedPrefix: 'Patched match #',
    patchedSuffix: ': ',
    exportFallbackShort: 'Export fell back to stored output',
    exportFallbackDetails: 'Recompute failed; using stored historical output.',
    exportFallbackAction: 'Details',
    exportFallbackClose: 'Hide',
    copyErrorSummary: 'Copy error summary',
    copyDiagnosticPack: 'Copy full diagnostic pack',
    copyDiagnosticPackMasked: 'Copy masked diagnostic pack',
    maskLevelLabel: 'Mask level',
    maskBadgePrefix: 'MASK',
    maskLevelHint: 'Affects masked diagnostic copy',
    maskLegend: 'A=safer, B=more info',
    showLegend: 'Show legend',
    hideLegend: 'Hide legend',
  },
}

export const t = (lang: Lang, key: string) => dict[lang][key] ?? dict.zh[key] ?? key

export const detectBrowserLang = (): Lang => {
  if (typeof navigator === 'undefined') return 'zh'
  return navigator.language.toLowerCase().startsWith('zh') ? 'zh' : 'en'
}

export const dateLocale = (lang: Lang) => (lang === 'zh' ? 'zh-CN' : 'en-US')
